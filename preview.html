<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MoodleGPT UI Preview</title>
    <link rel="stylesheet" href="extension/popup/style.css" />
    <style>
      body {
        margin: 0;
        padding: 20px;
        background: #f5f5f5;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
      }
      .preview-container {
        background: white;
        border-radius: 8px;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        max-width: 400px;
      }
    </style>
  </head>
  <body>
    <div class="preview-container">
      <main class="container">
        <!-- Header -->
        <header class="header">
          <div class="header-content">
            <div class="logo-container">
              <img src="extension/icon.png" alt="MoodleGPT Icon" class="logo" />
              <div class="status-indicator" title="Extension Active"></div>
            </div>
            <div class="header-text">
              <h1>MoodleGPT</h1>
              <p id="version" class="version">v1.1.3</p>
            </div>
          </div>
        </header>

        <!-- API Configuration Section -->
        <section class="section">
          <h2 class="section-title">API Configuration</h2>

          <!-- Provider Selector -->
          <div class="form-group">
            <div class="provider-selector">
              <label for="providerOpenAI" class="provider-option selected"> OpenAI </label>
              <input
                type="radio"
                id="providerOpenAI"
                name="apiProvider"
                value="openai"
                class="sr-only"
                checked
              />
              <label for="providerGemini" class="provider-option"> Gemini </label>
              <input
                type="radio"
                id="providerGemini"
                name="apiProvider"
                value="gemini"
                class="sr-only"
              />
            </div>
          </div>

          <!-- API Key Inputs -->
          <div id="openai_config" class="form-group">
            <label for="apiKey" class="form-label">OpenAI API Key*</label>
            <input
              id="apiKey"
              type="password"
              placeholder="sk-..."
              class="form-input"
              autocomplete="off"
            />
          </div>

          <!-- Model Selection -->
          <div class="form-group">
            <label for="model" class="form-label">Model*</label>
            <div class="input-with-button">
              <input
                type="text"
                id="model"
                placeholder="gpt-4o, gemini-1.5-flash, ..."
                class="form-input"
              />
              <button
                id="check-model"
                type="button"
                class="btn btn-icon"
                title="Test Model"
                aria-label="Test Model"
              >
                ▶
              </button>
            </div>
          </div>

          <!-- Advanced Settings Toggle -->
          <a
            id="switch-settings"
            href="#"
            class="settings-toggle"
            role="button"
            aria-expanded="false"
          >
            Advanced Settings
          </a>
        </section>

        <!-- Mode Selection Section -->
        <section class="section">
          <h2 class="section-title">Operation Mode</h2>
          <div class="mode-grid" id="mode" role="radiogroup" aria-label="Select operation mode">
            <button
              type="button"
              value="autocomplete"
              class="mode-button selected"
              role="radio"
              aria-checked="true"
              aria-label="Autocomplete mode"
            >
              Autocomplete
            </button>
            <button
              type="button"
              value="clipboard"
              class="mode-button"
              role="radio"
              aria-checked="false"
              aria-label="Clipboard mode"
            >
              Clipboard
            </button>
            <button
              type="button"
              value="question-to-answer"
              class="mode-button"
              role="radio"
              aria-checked="false"
              aria-label="Question to Answer mode"
            >
              Q & A
            </button>
          </div>
        </section>

        <!-- Options Section -->
        <section class="section">
          <h2 class="section-title">Options</h2>
          <div class="options-grid">
            <div class="option-item">
              <input id="logs" type="checkbox" class="option-checkbox" />
              <label for="logs" class="option-label">Console logs</label>
            </div>
            <div class="option-item">
              <input id="typing" type="checkbox" class="option-checkbox" />
              <label for="typing" class="option-label">Typing effect</label>
            </div>
            <div class="option-item">
              <input id="title" type="checkbox" checked class="option-checkbox" />
              <label for="title" class="option-label">Title indication</label>
            </div>
            <div class="option-item">
              <input id="mouseover" type="checkbox" class="option-checkbox" />
              <label for="mouseover" class="option-label">Mouseover effect</label>
            </div>
          </div>
        </section>

        <!-- Actions Section -->
        <section class="section">
          <button type="button" class="save btn btn-primary btn-full">Save Changes</button>
          <div id="message" class="message success" role="alert" aria-live="polite">
            Settings saved successfully!
          </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
          <div class="footer-links">
            <a
              href="https://www.buymeacoffee.com/yoannchbpro"
              target="_blank"
              rel="noopener noreferrer"
              class="footer-link"
            >
              Donate
            </a>
            <div class="footer-divider"></div>
            <a
              href="https://github.com/yoannchb-pro/MoodleGPT"
              target="_blank"
              rel="noopener noreferrer"
              class="footer-link"
            >
              Documentation
            </a>
            <div class="footer-divider"></div>
            <a
              href="https://github.com/yoannchb-pro/MoodleGPT/issues"
              target="_blank"
              rel="noopener noreferrer"
              class="footer-link"
            >
              Support
            </a>
          </div>
        </footer>
      </main>
    </div>

    <script>
      // Simple interactive preview
      document.addEventListener('DOMContentLoaded', function() {
        // Provider selector - Lógica mejorada
        const providerOptions = document.querySelectorAll('.provider-option');
        const providerRadios = document.querySelectorAll('input[name="apiProvider"]');
        
        function updateProviderSelection() {
          const selectedProvider = document.querySelector('input[name="apiProvider"]:checked').value;
          
          // Limpiar todas las selecciones
          providerOptions.forEach(opt => opt.classList.remove('selected'));
          
          // Marcar el correcto como seleccionado
          const selectedLabel = document.querySelector(`label[for="provider${selectedProvider.charAt(0).toUpperCase() + selectedProvider.slice(1)}"]`);
          if (selectedLabel) {
            selectedLabel.classList.add('selected');
          }
        }
        
        providerOptions.forEach(option => {
          option.addEventListener('click', function() {
            const forAttribute = this.getAttribute('for');
            if (forAttribute) {
              const radio = document.getElementById(forAttribute);
              if (radio) {
                radio.checked = true;
                updateProviderSelection();
              }
            }
          });
        });
        
        providerRadios.forEach(radio => {
          radio.addEventListener('change', updateProviderSelection);
        });

        // Mode buttons
        const modeButtons = document.querySelectorAll('.mode-button');
        modeButtons.forEach(button => {
          button.addEventListener('click', function() {
            modeButtons.forEach(btn => {
              btn.classList.remove('selected');
              btn.setAttribute('aria-checked', 'false');
            });
            this.classList.add('selected');
            this.setAttribute('aria-checked', 'true');
          });
        });

        // Settings toggle
        const settingsToggle = document.getElementById('switch-settings');
        settingsToggle.addEventListener('click', function(e) {
          e.preventDefault();
          const expanded = this.getAttribute('aria-expanded') === 'true';
          this.setAttribute('aria-expanded', !expanded);
        });

        // Save button
        const saveButton = document.querySelector('.save');
        const message = document.getElementById('message');
        saveButton.addEventListener('click', function() {
          message.className = 'message success';
          message.textContent = 'Settings saved successfully!';
          message.classList.remove('hidden');
          
          setTimeout(() => {
            message.classList.add('hidden');
          }, 3000);
        });
        
        // Model validation button
        const checkModelBtn = document.getElementById('check-model');
        checkModelBtn.addEventListener('click', function() {
          message.className = 'message loading';
          message.textContent = 'Probando el modelo...';
          message.classList.remove('hidden');
          
          // Simular validación
          setTimeout(() => {
            message.className = 'message success';
            message.textContent = '¡El modelo es válido!';
            
            setTimeout(() => {
              message.classList.add('hidden');
            }, 3000);
          }, 2000);
        });
      });
    </script>
  </body>
</html>
